<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Cipher Decoder</title>
    <script src="https://unpkg.com/webcam-easy@1.0.5/dist/webcam-easy.min.js"></script>
    <script src="https://unpkg.com/tesseract.js@2.1.0/dist/tesseract.min.js"></script>
    <style>
        #videoContainer {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin: 20px auto;
        }
        #output {
            margin: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            display: none;
        }
    </style>
</head>
<body>
    <div id="videoContainer">
        <video id="webcam" autoplay playsinline></video>
        <canvas id="canvas" style="display:none;"></canvas>
    </div>
    <div id="output"></div>

    <script>
        const webcamElement = document.getElementById('webcam');
        const canvasElement = document.getElementById('canvas');
        const outputElement = document.getElementById('output');
        
        // Initialize Webcam with back camera
        const webcam = new Webcam(webcamElement, 'environment', canvasElement);
        
        // Target ciphertext (case-insensitive comparison)
        const targetCipher = "Zhofrph wr VHX Xqlyhuvlwb! Zh duh gholjkwhg wr kdyh brx zlwk xv wrgdb dv zh vkrzfdvh rxu dgydqfhphqwv lq frpsxwlqj vhfxulwb. Brxu ylvlw lv dq krqru, dqg zh orrn iruzdug wr lqvljkwixo glvfxvvlrqv dqg ixwxuh fROoderudwlrqv".toLowerCase();
        
        // Decoded message (shift 3)
        const decodedMessage = "Welcome to SEU University! We are delighted to have you with us today as we showcase our advancements in computing security. Your visit is an honor, and we look forward to insightful discussions and future collaborations";

        // Function to decode Caesar cipher (shift 3)
        function decodeCipher(text) {
            return text.replace(/[a-zA-Z]/g, function(char) {
                let code = char.charCodeAt(0);
                let base = code <= 90 ? 65 : 97; // Handle both uppercase and lowercase
                return String.fromCharCode((code - base - 3 + 26) % 26 + base);
            });
        }

        // Start webcam
        webcam.start()
            .then(result => {
                console.log("Webcam started");
                scanForText();
            })
            .catch(err => {
                console.log(err);
            });

        // Scan for text periodically
        function scanForText() {
            webcam.snap(); // Take a snapshot
            Tesseract.recognize(
                canvasElement,
                'eng',
                { 
                    logger: m => console.log(m) 
                }
            ).then(({ data: { text } }) => {
                const detectedText = text.toLowerCase().replace(/[^a-zA-Z\s!.]/g, '');
                
                // Check if detected text matches target cipher (allowing for minor OCR errors)
                if (detectedText.includes(targetCipher.substring(0, 20))) {
                    outputElement.style.display = 'block';
                    outputElement.innerHTML = `
                        <h2>Decoded Message:</h2>
                        <p>${decodedMessage}</p>
                    `;
                }
                
                // Continue scanning
                setTimeout(scanForText, 1000);
            }).catch(err => {
                console.log(err);
                setTimeout(scanForText, 1000);
            });
        }
    </script>
</body>
</html>
